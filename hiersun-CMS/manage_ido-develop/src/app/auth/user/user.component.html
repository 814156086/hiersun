<div class="page-head">
    <div class="page-title">
        <h1>
            用户管理
            <small>
                User The Management
            </small>
        </h1>
    </div>
</div>
<div class="row" style="padding:10px;background:white;">
    <div class="col-md-12">
        <div class="col-md-12">
            <div class="col-md-3">
                <input id="searchname" class="form-control col-md-12" type="text" placeholder="全局查询" />
            </div>
            <div class="col-md-3">
                <button class="btn btn-primary" (click)="search()">查询</button>
                <button class="btn btn-primary" (click)="search2()">按部门查询</button>
                <button class="btn btn-waring" (click)="request()">重置</button>
            </div>
        </div>
        <div class="app col-md-12">
            <div class="col-md-3" style="margin-top:15px;">
                <div class="portlet box blue-hoki" style="overflow:hidden;">
                    <div class="portlet-title">
                        <div class="caption">
                            <i class="fa fa-globe"></i>用户部门
                        </div>
                        <div class="tools">
                            <a href="javascript:;" class="collapse" data-original-title="" title=""></a>
                            <a data-original-title="" title="" (click)="reloadPage()">
                                <i class="fa fa-refresh" style="color:#fff;position: relative;top:-2px;"></i>
                            </a>
                        </div>
                    </div>
                    <div class="portlet-body msg_box">
                        <div class="pleftTree">
                            <input type="hidden" name="mymsg" />
                            <button class="myclick" (click)="myclick()"></button>
                            <div class="zTreeDemoBackground">
                                <ul id="ztree" class="ztree"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <div class="right_btn" style="margin-top:15px;margin-bottom:15px;">
                    <button class="btn green" routerLink="/auth/edituser"  *ngIf="userid!=0">添加用户</button>
                </div>

                <div class="right_c">
                    <div class="portlet box blue-hoki col-md-12">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="fa fa-globe"></i>用户详情
                            </div>
                            <div class="tools">
                                <a href="javascript:;" class="collapse" data-original-title="" title=""></a>
                            </div>
                        </div>
                        <div class="portlet-body col-md-12">
                            <div class="table-scrollable">
                                <table class="table table-striped table-bordered table-hover dataTable no-footer" id="sample_1"
                                    role="grid" aria-describedby="sample_1_info">
                                    <thead>
                                        <tr>
                                            <th>账号</th>
                                            <th>名称</th>
                                            <th>职位名称</th>
                                            <th>部门名称</th>
                                            <th>状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of cList">
                                            <td>{{item.username}}</td>
                                            <td>{{item.name}}</td>
                                            <td>{{item.dutyName}}</td>
                                            <td>{{item.deptName}}</td>
                                            <td *ngIf="item.enabled==1">已启用</td>
                                            <td *ngIf='item.enabled==0'>已禁用</td>
                                            <td *ngIf='item.enabled==-1'>已锁定</td>
                                            <td>
                                                <a class="btn btn-xs yellow" routerLink="/auth/edituser/" [queryParams]="{id:item.id}">
                                                    <i class="fa fa-edit"></i>
                                                    编辑
                                                </a>
                                                <a class="btn btn-xs green" (click)="operation(item.id,'true')" *ngIf="!item.enabled">
                                                    <i class="fa fa-trash-o"></i>
                                                    启用
                                                </a>
                                                <a class="btn btn-xs red" (click)="operation(item.id,'false')" *ngIf="item.enabled">
                                                    <i class="fa fa-trash-o"></i>
                                                    禁用
                                                </a>
                                                <a class="btn btn-xs btn-success" (click)="reset(item.id)" data-toggle="modal"
                                                    data-target="#resetModal">
                                                    <i class="fa fa-trash-o"></i>
                                                    重置密码
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <!--pagema-->
                            <div class="clearfix box">
                                <div id="pagination1" class="page fr"></div>
                            </div>
                            <!--pagema-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--编辑弹框-->
<div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
    style="margin-top:5%;z-index:999;">
    <div class="modal-dialog" style="width:1000px; ">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" (click)="cancel()">&times;</button>
                <h4 class="modal-title" id="myModalLabel5">编辑用户</h4>
            </div>
            <div class="portlet-body col-md-12" style="padding-left:0px;" *ngFor="let item of editList">

                <nz-tabset>
                    <nz-tab nzTitle="基本信息">
                        <div class="col-md-6">
                            <!-- 用户名 -->
                            <div class="col-md-12">
                                <span class="col-md-4" style="text-align:right;">
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">
                                            <span style="color:red;">*</span>用户名：</font>
                                    </font>
                                </span>
                                <div class="col-md-8">
                                    <input type="text" value="{{item.username}}" class="form-control col-md-12" id="Eusername"
                                        readonly />
                                </div>
                            </div>
                            <!-- 姓名 -->
                            <div class="col-md-12">
                                <label class="col-md-4" style="text-align:right;">
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">
                                            <span style="color:red;">*</span>姓名：</font>
                                    </font>
                                </label>
                                <div class="col-md-8">
                                    <input type="text" name="ename" class="form-control col-md-12" id="Ename" value="{{item.name}}" />
                                </div>
                            </div>
                            <!-- 手机号 -->
                            <div class="col-md-12" [formGroup]="formModel">
                                <span class="col-md-4" style="text-align:right;">手机号：</span>
                                <div class="col-md-8">
                                    <input placeholder="请输入手机号" type="text" [(ngModel)]="mobile" class="form-control col-md-12"
                                        id="Emobile" maxlength="11" formControlName="mobile">
                                    <div [hidden]="formModel.get('mobile').valid || formModel.get('mobile').pristine ">
                                        <div class="formtips" [hidden]="!formModel.hasError('mobile', ['mobile'])">
                                            请输入正确的手机号
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- 邮箱 -->
                            <div class="col-md-12" [formGroup]="formModel">
                                <span class="col-md-4" style="text-align:right;">邮箱：</span>
                                <div class="col-md-8">
                                    <input placeholder="请输入邮箱" type="text" class="form-control col-md-12" [(ngModel)]="email"
                                        value="{{item.email}}" id="Eemail" formControlName="email">
                                    <div [hidden]="formModel.get('email').valid || formModel.get('email').pristine ">
                                        <div class="formtips" [hidden]="!formModel.hasError('email', ['email'])">
                                            请输入正确的邮箱
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" [formGroup]="formModel">
                                <span class="col-md-4" style="text-align:right;">员工编号：</span>
                                <div class="col-md-8">
                                    <input placeholder="请输入员工编号" id="editemployee" type="text" class="form-control col-md-12"
                                        value="{{item.employeeId}}">
                                </div>
                            </div>

                        </div>
                        <div class="col-md-6">
                            <div class="col-md-12">
                                <span class="col-md-4" style="text-align:right;">
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">
                                            <span style="color:red;">*</span>部门：</font>
                                    </font>
                                </span>
                                <div class="col-md-8">
                                    <div class="form-control" style="border: 1px solid #ccc;height: 34px;border-radius: 5px;padding: 6px 10px; box-sizing: border-box;overflow:hidden;white-space:nowrap;"
                                        *ngFor="let item of ztreename" id="deptID" title="{{item.id}}" (click)="tab(item.id)">
                                        <input type="hidden" id="dept" value="{{item.id}}" /> {{item.name}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" style="margin-bottom:5px;">
                                <div class="col-md-4">
                                </div>
                                <div class="col-md-8" id="deptTree" style="display:none;">
                                    <input type="hidden" name="mymsg3" />
                                    <button class="myclick3" (click)="myclick3()"></button>
                                    <div class="zTreeDemoBackground">
                                        <ul id="ztree3" class="ztree"></ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" style="margin-bottom: 5px;">
                                <span class="col-md-4" style="text-align:right;">职位：</span>
                                <div class="col-md-8">
                                    <div class="form-control" style="border: 1px solid #ccc;height: 34px;border-radius: 5px;padding: 6px 10px; box-sizing: border-box;overflow:hidden;white-space:nowrap;"
                                        *ngFor="let item of dutylist" id="chooseduty" (click)="chooseduty(item.id)">
                                        <input type="hidden" id="duty" value="{{item.id}}" /> {{item.name}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" style="margin-bottom:5px;">
                                <div class="col-md-4">
                                </div>
                                <div class="col-md-8" id="dutyTree" style="display:none;">
                                    <input type="hidden" name="dutymsg" />
                                    <button class="dutyclick" (click)="dutyclick()"></button>
                                    <div class="zTreeDemoBackground">
                                        <ul id="dutyztree" class="ztree"></ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-12" style="margin-top:6px;">
                                    <span class="col-md-4 control-label">有效时间：</span>
                                    <div class="col-md-8">
                                        <nz-date-picker id="editstartdate" class="col-md-6" nzPlaceHolder="{{startDate | date:'yyy-MM-dd'}}"
                                            (nzOnOk)="onOk($event)">

                                        </nz-date-picker>
                                        <nz-date-picker id="editenddate" class="col-md-6" nzPlaceHolder="{{endDate | date:'yyy-MM-dd'}}"
                                            (nzOnOk)="OnOk($event)">

                                        </nz-date-picker>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" style="margin-top:8px;">
                                <span class="col-md-4" style="text-align:right;">状态：</span>
                                <div class="col-md-8 form-control" style="border: 0;width: 40%; margin-bottom: 5px;">
                                    <input *ngIf="enabled" value="1" type="radio" name="Eenabled" checked>
                                    <input *ngIf="!enabled" value="1" type="radio" name="Eenabled">
                                    启用
                                    <input type="radio" *ngIf="!enabled" value="0" checked name="Eenabled">
                                    <input type="radio" *ngIf="enabled" value="0" name="Eenabled">
                                    禁用
                                    <input type="radio" *ngIf="!enabled" value="-1" checked name="Eenabled">
                                    <input type="radio" *ngIf="enabled" value="-1" name="Eenabled">
                                    锁定

                                </div>
                            </div>
                            <div class="col-md-12" style="pading:7%">

                            </div>
                            <div class="col-md-12" style="margin-top:8px;">
                                <span class="col-md-4 control-label" style="text-align:right;">是否AD域：</span>
                                <div class="col-md-8">
                                    <input type="checkbox" disabled *ngIf="!synStatus" value="0" checked>
                                    <input type="checkbox" disabled *ngIf="synStatus" value="0">
                                    是
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12" style="padding:11.5%;">

                        </div>
                        <div class="col-md-12">
                            <button style="float:right; margin-right: 15px;" class="btn green" (click)="tabs5()">下一页</button>
                        </div>
                    </nz-tab>
                    <nz-tab nzTitle="权限" (nzClick)="auth()">
                        <div class="col-md-12">
                            <!-- 关联用户组 -->
                            <div class="col-md-7">
                                <div class="portlet box blue-hoki col-md-12">
                                    <div class="portlet-title">
                                        <div class="caption">
                                            <i class="fa fa-globe"></i>关联角色
                                        </div>
                                        <div class="tools">
                                            <a href="javascript:;" class="collapse" data-original-title="" title=""></a>
                                        </div>
                                    </div>
                                    <div class="portlet-body msg_box col-md-12" style="margin-bottom:0;border-right:1px solid #67809F;">

                                        <!-- 系统树 -->
                                        <div class="pleftTree" style="width:40%;height:400px;float:left;">
                                            <input type="hidden" name="linkmsg" />
                                            <button class="linkclick" (click)="linkclick()"></button>
                                            <div class="zTreeDemoBackground">
                                                <ul id="linkztree" class="ztree"></ul>
                                            </div>
                                        </div>
                                        <nz-select class="form-control" nzMode="multiple" nzPlaceHolder="请选择" style="width: 55%;float:left;margin-top:30px;"
                                            [(ngModel)]="editRoleValue" [nzAllowClear]="true">
                                            <nz-option *ngFor="let option of roleList2" [nzLabel]="option.name"
                                                [nzValue]="option.key"></nz-option>
                                        </nz-select>
                                       </div>
                                </div>
                            </div>
                            <!-- 关联角色 -->
                            <div class="col-md-5">
                                <div class="portlet box blue-hoki">
                                    <div class="portlet-title">
                                        <div class="caption">
                                            <i class="fa fa-globe"></i>关联用户组
                                        </div>
                                        <div class="tools">
                                            <a href="javascript:;" class="collapse" data-original-title="" title=""></a>
                                        </div>
                                    </div>
                                    <div class="portlet-body" style="height:420px;">
                                        <nz-select class="form-control" style="width: 100%" nzMode="multiple"
                                            nzPlaceHolder="Please select" [(ngModel)]="listOfSelectedValue">
                                            <nz-option *ngFor="let option of groupList" [nzLabel]="option.name"
                                                [nzValue]="option.key"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div class="col-md-12">
                            <button style="float:right; margin-right: 15px;" class="btn green" (click)="tabs6()">下一页</button>
                            <button style="float:right; margin-right: 15px;" class="btn yellow" (click)="tabs5()">上一页</button>
                        </div>
                    </nz-tab>
                    <nz-tab nzTitle="数据权限">
                        <div class="col-md-12">
                            <div style="width:32%; float:left;">
                                <div class="portlet box blue-hoki">
                                    <div class="portlet-title">
                                        <div class="caption">
                                            <i class="fa fa-globe"></i>门店
                                        </div>
                                        <div class="tools">
                                            <a href="javascript:;" class="collapse" data-original-title="" title=""></a>
                                        </div>
                                    </div>
                                    <div class="portlet-body" style="padding-bottom:243px;">
                                        <nz-select class="form-control" style="width: 100%" nzMode="multiple"
                                            nzPlaceHolder="请选择门店" [(ngModel)]="listOfEditStoreValue">
                                            <nz-option *ngFor="let option of editstoreList" [nzLabel]="option.name"
                                                [nzValue]="option.key"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>
                            </div>
                            <div style="width:32%; margin-left:1%; float:left;">
                                <div class="portlet box blue-hoki">
                                    <div class="portlet-title">
                                        <div class="caption">
                                            <i class="fa fa-globe"></i>品牌
                                        </div>
                                        <div class="tools">
                                            <a href="javascript:;" class="collapse" data-original-title="" title=""></a>
                                        </div>
                                    </div>
                                    <div class="portlet-body" style="padding-bottom:243px;">
                                        <nz-select class="form-control" style="width: 100%" nzMode="multiple"
                                            nzPlaceHolder="请选择品牌" [(ngModel)]="listOfEditBrandValue">
                                            <nz-option *ngFor="let option of editbrandList" [nzLabel]="option.name"
                                                [nzValue]="option.key"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>
                            </div>
                            <div style="width:32%; margin-left:1%; float:left;">
                                <div class="portlet box blue-hoki">
                                    <div class="portlet-title">
                                        <div class="caption">
                                            <i class="fa fa-globe"></i>渠道
                                        </div>
                                        <div class="tools">
                                            <a href="javascript:;" class="collapse" data-original-title="" title=""></a>
                                        </div>
                                    </div>
                                    <div class="portlet-body" style="padding-bottom:243px;">
                                        <nz-select class="form-control" style="width: 100%" nzMode="multiple"
                                            nzPlaceHolder="请选择渠道" [(ngModel)]="listOfEditChannelValue">
                                            <nz-option *ngFor="let option of editchannelList" [nzLabel]="option.name"
                                                [nzValue]="option.key"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12" style="padding:6.8%;">

                        </div>
                        <div class="col-md-12">


                            <button style="float:right; margin-right: 15px;" type="button" class="btn btn-primary"
                                (click)="editSure()">保存</button>
                            <button style="float:right; margin-right: 15px;" type="button" class="btn btn-default"
                                data-dismiss="modal" (click)="cancel()">取消</button>
                            <button style="float:right; margin-right: 15px;" class="btn yellow" (click)="tabs5()">上一页</button>
                        </div>
                    </nz-tab>
                </nz-tabset>


                <!-- <div class="col-md-12" style="padding-left:0px;">
                    <div class="col-md-12" style="padding-left: 0px;">
                        <ul class="col-md-7 ul" style="padding-right:0;padding-left: 0px;">
                            <li class="col-md-4 active" id="tab4" (click)="tabs4()">基本信息</li>
                            <li class="col-md-4" id="tab5" (click)="tabs5()">权限</li>
                            <li class="col-md-4" id="tab6" (click)="tabs6()">数据权限</li>
                        </ul>
                        <ul class="col-md-5 ul" style="color:white;padding-left:0;">
                            <li class="col-md-12" style="padding-left:0;">1</li>
                        </ul>
                    </div>
                </div> -->
                <!-- 第一页 -->

                <!-- 第二页 -->

                <!-- 第三页 -->

                <!-- <div class="col-md-6">
                        <div class="col-md-12">
                            <span class="col-md-3" style="text-align:right;">关联用户组：</span>
                            <div class="col-md-9" style="overflow:auto;">
                                <nz-select class="form-control" nzMode="multiple" nzPlaceHolder="请选择" [(ngModel)]="editGroupValue"
                                    [nzAllowClear]="true">
                                    <nz-option *ngFor="let option of groupList" [nzLabel]="option.name" [nzValue]="option.key"></nz-option>
                                </nz-select>
                            </div>
                        </div>
                        <div class="col-md-12" style="margin-top:6px;">
                            <span class="col-md-3" style="text-align:right;">关联角色：</span>
                            <div class="col-md-9" style="overflow:auto;">
                                <nz-select class="form-control" nzMode="multiple" nzPlaceHolder="请选择" [(ngModel)]="editRoleValue"
                                    [nzAllowClear]="true">
                                    <nz-option *ngFor="let option of roleList" [nzLabel]="option.name" [nzValue]="option.key"></nz-option>
                                </nz-select>
                            </div>
                        </div>
                    </div> -->

            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>
<!--编辑弹框end-->
<!--操作弹框-->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabe2">部门子类列表</h4>
            </div>
            <div class="modal-body">{{message}}</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="sure()">确定</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            </div>
        </div>
    </div>
</div>
<!--操作弹框end-->

<!--重置密码弹框-->
<div class="modal fade" id="resetModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel3">重置密码</h4>
            </div>
            <div class="modal-body col-md-12">
                <label class="col-md-3  control-label">请输入密码：</label>
                <div class="col-md-9">
                    <input type="password" id="reset" class="form-control">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="subStatus()">确定</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>
<!-- 添加弹框  end-->
<div id="hint" *ngIf="isHint">
    <div class="hintMsg">{{hintMsg}}</div>
</div>
<div class="partload">
    <div class="spinner">
        <div class="bounce1"></div>
        <div class="bounce2"></div>
        <div class="bounce3"></div>
    </div>
</div>
<div class="modal fade" id="myModal4" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">提示</h4>
            </div>
            <div class="modal-body">{{message}}</div>
            <div class="modal-footer">
                <button class="btn default" data-dismiss="modal" aria-hidden="true">关闭</button>
            </div>
        </div>
    </div>
</div>
